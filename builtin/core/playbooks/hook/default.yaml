---
- hosts:
    - all
  gather_facts: true
  tags: ["always"]  
  vars:
    architectures:
      amd64:
        - amd64
        - x86_64
      arm64:
        - arm64
        - aarch64
  tasks:
    - name: Get os arch for each node
      tags: ["always"]  
      set_fact:
        binary_type: >-
          {{- if .architectures.amd64 | has .os.architecture -}}
          amd64
          {{- else if .architectures.arm64 | has .os.architecture -}}
          arm64
          {{- end -}}

- hosts:
    - all
  tags: ["always"]  
  vars:
    # work_dir: default is <current_dir>/kubekey
    binary_dir: >-
      {{ .work_dir }}/kubekey
    scripts_dir: >-
      {{ .binary_dir }}/scripts
    tmp_dir: /tmp/kubekey